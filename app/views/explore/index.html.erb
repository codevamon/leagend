<h1>Explorar Leagend</h1>

<div class="row">
  <div class="col-md-8">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Duelos próximos</h5>
        <% if @upcoming_duels.any? %>
          <% @upcoming_duels.each do |duel| %>
            <div class="duel-card mb-3">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6><%= duel.duel_type.titleize %></h6>
                  <p class="mb-0">
                    <%= duel.home_team.name %> vs <%= duel.away_team&.name || "Por confirmar" %>
                  </p>
                  <small class="text-muted">
                    <%= duel.starts_at.strftime("%d/%m/%Y %H:%M") %> en <%= duel.arena&.name || "Cancha por confirmar" %>
                  </small>
                </div>
                <div>
                  <%= link_to "Ver detalles", duel_path(duel), class: "btn btn-sm btn-outline-primary" %>
                </div>
              </div>
            </div>
          <% end %>
          <%= link_to "Ver todos los duelos", explore_duels_path, class: "btn btn-primary" %>
        <% else %>
          <p class="text-muted">No hay duelos programados</p>
        <% end %>
      </div>
    </div>

    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Arenas disponibles</h5>
        <% if @available_arenas.any? %>
          <div class="row">
            <% @available_arenas.each do |arena| %>
              <div class="col-md-6 mb-3">
                <div class="arena-card">
                  <h6><%= arena.name %></h6>
                  <p class="mb-0"><%= arena.address %></p>
                  <small class="text-muted">
                    Próximo horario disponible: <%= arena.next_available_slot&.strftime("%H:%M") || "No disponible" %>
                  </small>
                </div>
              </div>
            <% end %>
          </div>
          <%= link_to "Ver todas las arenas", explore_arenas_path, class: "btn btn-primary" %>
        <% else %>
          <p class="text-muted">No hay arenas disponibles en este momento</p>
        <% end %>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Jugadores libres</h5>
        <% if @free_players.any? %>
          <% @free_players.each do |player| %>
            <div class="player-card mb-3">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6><%= player.name %></h6>
                  <small class="text-muted">
                    <%= player.profile&.position || "Posición no especificada" %> |
                    Nivel: <%= player.profile&.skill_level || "No especificado" %>
                  </small>
                </div>
                <div>
                  <%= link_to "Ver perfil", user_path(player), class: "btn btn-sm btn-outline-primary" %>
                </div>
              </div>
            </div>
          <% end %>
          <%= link_to "Ver todos los jugadores", explore_players_path, class: "btn btn-primary" %>
        <% else %>
          <p class="text-muted">No hay jugadores libres en este momento</p>
        <% end %>
      </div>
    </div>

    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Filtros rápidos</h5>
        <%= form_tag explore_path, method: :get, class: "mb-3" do %>
          <div class="mb-3">
            <%= label_tag :type, "Tipo de duelo" %>
            <%= select_tag :type, 
              options_for_select(Duel.duel_types.keys.map { |t| [t.titleize, t] }), 
              include_blank: "Todos",
              class: "form-control" 
            %>
          </div>

          <div class="mb-3">
            <%= label_tag :date, "Fecha" %>
            <%= date_field_tag :date, nil, class: "form-control" %>
          </div>

          <div class="mb-3">
            <%= label_tag :location, "Ubicación" %>
            <%= text_field_tag :location, nil, class: "form-control", placeholder: "Ciudad o barrio" %>
          </div>

          <%= submit_tag "Filtrar", class: "btn btn-primary w-100" %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<% content_for :styles do %>
  <style>
    .duel-card, .arena-card, .player-card {
      padding: 1rem;
      border: 1px solid #dee2e6;
      border-radius: 0.25rem;
    }

    .duel-card:hover, .arena-card:hover, .player-card:hover {
      background-color: #f8f9fa;
    }
  </style>
<% end %> 